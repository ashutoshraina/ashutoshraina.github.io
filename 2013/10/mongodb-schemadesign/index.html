<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="last-modified" content="2015-01-15T12:11:41.6880220+05:30" />
    <title>Ashutosh Raina</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css" />
    <link rel="shortcut icon" href="/stylesheets/images/me.png" type="image/png">
    <link rel="shortcut icon" type="image/png" href="/stylesheets/images/me.png" />
	<link rel="stylesheet" type="text/css" href="/stylesheets/font-awesome/css/font-awesome.min.css" />
    <link rel="canonical" href="http://ashutoshraina.github.io/2013/10/mongodb-schemadesign/" />
</head>
<body class="home blog">
    <div id="page" class="hfeed site">
        <header id="masthead" class="site-header fancy-container lightgreen" role="banner">
            <hgroup>
                <h1 class="site-title"><a href="/" title="ashutoshraina.github.io" rel="home">Ashutosh Raina</a></h1>
                <h2 class="site-title"><small>For those who are still chasing</small></h2>
                <p class="site-description">I love french fries!!</p>
            </hgroup>
            <nav role="navigation" class="site-navigation main-navigation">
                <h1 class="assistive-text">Menu</h1>
                <div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to    content</a>
                </div>
                <div class="menu">
                    <ul>
						<li><a href="/" class="home"><i class="fa fa-home"></i></a></li>
                        <li><a href="/archive">Archive</a></li>
                        <li><a href="/category">Categories</a></li>                        
                        <li><a href="/about">About</a></li>
                        <li><a href="/feed.xml">RSS/Atom</a></li>
                    </ul>
                </div>
            </nav>
        </header>

        <div id="main">

            <div id="primary" class="site-content">
                <div id="content" role="main">
                  

<div id="post">
    <h1>MongoDB-Schema Design</h1>
    
	<div class="meta">
        <p class="posted">02 Oct 2013</p>
        <ul class="categories">
          <li><a href="/category/.net" title="Snow.Models.Category">.net</a></li>
          <li><a href="/category/csharp" title="Snow.Models.Category">csharp</a></li>
          <li><a href="/category/mongodb" title="Snow.Models.Category">mongodb</a></li>
          <li><a href="/category/opensource" title="Snow.Models.Category">opensource</a></li>
        </ul>
      </div>
    
	<div class="addthis_toolbox addthis_default_style" style="float:right;">
        <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
        <a class="addthis_button_tweet"></a>
        <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
        <a class="addthis_button_linkedin_counter"></a>
        <a class="addthis_counter addthis_pill_style"></a>
      </div>
	  
    
        
    <p>This is a short post on Schema Design.</p>

<p>Schema Design in MongoDB</p>

<ul>
<li>Application Driven Schema is the best way to store data in MongoDB</li>
<li>MongoDB stores rich documents i.e. store embedded documents , arrays etc..</li>
<li>Joins happen at the application level not at the database level.</li>
<li>There are no constraints in the database.</li>
<li>No support for transactions.</li>
<li>Support for Atomic present operations is present.</li>
<li>Tip : Embed as much as you can.</li>
</ul>

<p><!--excerpt-->
Relational Normalisation</p>

<ul>
<li>Frees the database of modification anomalies</li>
<li>Achieve extensibility.</li>
<li>Removes bias towards a particular access pattern.</li>
<li>Constraints are supposed to be handled at the application level</li>
<li>Transactions are also not present in the database.</li>
</ul>

<p>Mapping Strategies</p>

<p>Considerations 
    Query access pattern.
    Which collections will grow.
<strong>1:1</strong></p>

<p>Two documents related to each other can be kept in separate collections :
    To reduce the working set size of your application.
    Because the combined size of the documents would be larger than 16MB</p>

<p><strong>1: M</strong></p>

<p>We should have true linking in this case.
i.e. have collection for each type.</p>

<p>If it is 1 to few then we can embed it in the 1 collection.</p>

<p><strong>M: M</strong></p>

<p>e.g. Student and Teacher</p>

<pre><code>Generally make both of them separate collections. 
Link in one direction.
At the risk of duplication we can link both ways but that should be done only when 
    we have performance considerations.
</code></pre>

<p>When to De-Normalise ?</p>

<pre><code>1: 1 Embed
1 : M Embed from the many to one
M : M Link
</code></pre>


    <div id="disqus_thread"></div>
<script>
    var reset_disqus = function(){
        DISQUS.reset({
            reload: true,
            config: function () {
                //this.page.identifier = '';
                this.page.url = 'http://ashutoshraina.github.io/2013/10/mongodb-schemadesign/';
                //this.page.title = '';
            }
        });
    };

    var disqus_shortname = 'ashutoshraina';
    var disqus_url = 'http://ashutoshraina.github.io/2013/10/mongodb-schemadesign/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    window.addEventListener('orientationchange', reset_disqus);
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
   <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-52ba834d16119580">
   </script>

</div>
                </div>
                <!-- #content -->
            </div>
            <!-- #primary .site-content -->      
        <!-- #main -->

        <footer id="colophon" class="site-footer" role="contentinfo">
            <div class="site-info">
                Powered by <a href="https://github.com/Sandra/Sandra.Snow" rel="generator">Sandra.Snow</a>.	
            </div>
            <!-- .site-info -->
        </footer>
        <!-- #colophon .site-footer -->
    </div>
    <!-- #page .hfeed .site -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src='/javascripts/prettify.js' type='text/javascript'></script>
    
    <script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(['_setAccount', 'UA-46699881-1']);
_gaq.push(['_trackPageview']);
        
(function () {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
})();
</script>
    
    <script type='text/javascript'>
      $(function () {
        $("pre code").parent().each(function () {
          if (!$(this).hasClass("prettyprint")) {
            $(this).addClass("prettyprint");
            a = true
          }
        });

        prettyPrint();
      });
    </script>
</body>
</html>
